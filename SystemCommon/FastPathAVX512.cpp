#include "common/CommonRely.hpp"

#define COMMON_SIMD_LV_NAMESPACE 1
#define COMMON_SIMD_LV 320
#include "common/simd/SIMD.hpp"
#if COMMON_SIMD_LV_ < COMMON_SIMD_LV
#   error requires SIMDLV >= 320
#endif
#include "common/simd/SIMD128.hpp"
#include "common/simd/SIMD256.hpp"

#include "CopyExIntrin.inl"
#include "MiscIntrins.inl"


DEFINE_FASTPATH_PARTIAL(CopyManager, AVX512)
{
    //REGISTER_FASTPATH_VARIANTS(Broadcast2, AVX, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(Broadcast4, AVX, SIMD128);
    REGISTER_FASTPATH_VARIANTS(ZExtCopy12, AVX512VBMI2, AVX512BW);
    REGISTER_FASTPATH_VARIANTS(ZExtCopy14, AVX512VBMI2, AVX512F);
    REGISTER_FASTPATH_VARIANTS(ZExtCopy24, AVX512VBMI2, AVX512F);
    REGISTER_FASTPATH_VARIANTS(ZExtCopy28, AVX512VBMI2, AVX512F);
    REGISTER_FASTPATH_VARIANTS(ZExtCopy48, AVX512VBMI2, AVX512F);
    REGISTER_FASTPATH_VARIANTS(SExtCopy12, AVX512BW);
    REGISTER_FASTPATH_VARIANTS(SExtCopy14, AVX512F);
    REGISTER_FASTPATH_VARIANTS(SExtCopy24, AVX512F);
    REGISTER_FASTPATH_VARIANTS(SExtCopy28, AVX512F);
    REGISTER_FASTPATH_VARIANTS(SExtCopy48, AVX512F);
    REGISTER_FASTPATH_VARIANTS(TruncCopy21, AVX512VBMI, AVX512F);
    REGISTER_FASTPATH_VARIANTS(TruncCopy41, AVX512VBMI, AVX512F);
    REGISTER_FASTPATH_VARIANTS(TruncCopy42, AVX512VBMI, AVX512F);
    REGISTER_FASTPATH_VARIANTS(TruncCopy82, AVX512VBMI, AVX512F);
    REGISTER_FASTPATH_VARIANTS(TruncCopy84, AVX512VBMI, AVX512F);
    //REGISTER_FASTPATH_VARIANTS(CvtI32F32, AVX,  SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtI16F32, AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtI8F32,  AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtU32F32, AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtU16F32, AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtU8F32,  AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtF32I32, AVX,  SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtF32I16, AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtF32I8,  AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtF32U16, AVX2, SIMD128);
    //REGISTER_FASTPATH_VARIANTS(CvtF32U8,  AVX2, SIMD128);
    REGISTER_FASTPATH_VARIANTS(CvtF16F32, AVX512F);
    REGISTER_FASTPATH_VARIANTS(CvtF32F16, AVX512F);
    REGISTER_FASTPATH_VARIANTS(CvtF32F64, AVX512F);
    REGISTER_FASTPATH_VARIANTS(CvtF64F32, AVX512F);
}

DEFINE_FASTPATH_PARTIAL(MiscIntrins, AVX512)
{
    REGISTER_FASTPATH_VARIANTS(PopCounts, AVX512VPOPCNT);
}

DEFINE_FASTPATH_PARTIAL(DigestFuncs, AVX512)
{
    REGISTER_FASTPATH_VARIANTS(Sha256, SHANIAVX512BW);
}
